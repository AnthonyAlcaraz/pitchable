---
phase: 01-foundation
plan: 06
type: execute
wave: 3
depends_on: ["01-01", "01-03"]
files_modified:
  - apps/web/src/App.tsx
  - apps/web/src/pages/LoginPage.tsx
  - apps/web/src/pages/RegisterPage.tsx
  - apps/web/src/pages/ForgotPasswordPage.tsx
  - apps/web/src/pages/ResetPasswordPage.tsx
  - apps/web/src/pages/DashboardPage.tsx
  - apps/web/src/pages/SettingsPage.tsx
  - apps/web/src/pages/WorkspacePage.tsx
  - apps/web/src/components/layout/SplitScreen.tsx
  - apps/web/src/components/layout/Sidebar.tsx
  - apps/web/src/components/layout/AppLayout.tsx
  - apps/web/src/stores/auth.store.ts
  - apps/web/src/lib/api.ts
  - apps/web/src/components/auth/ProtectedRoute.tsx
autonomous: false

must_haves:
  truths:
    - "User sees login and register pages at /login and /register"
    - "User can register with email/password/name and gets redirected to dashboard"
    - "User can log in with email/password and gets redirected to dashboard"
    - "Dashboard shows the user's name, empty presentations list, and credit balance"
    - "Settings page shows account info and a placeholder for billing"
    - "User sees a split-screen layout when opening a workspace: empty chat panel left, empty preview panel right"
    - "Responsive: on mobile (< 768px), the split-screen collapses to tabbed view"
    - "Unauthenticated users are redirected to /login"
    - "Auth tokens are stored and refresh happens automatically"
  artifacts:
    - path: "apps/web/src/stores/auth.store.ts"
      provides: "Zustand store for auth state, tokens, login/register/logout actions"
      contains: "useAuthStore"
    - path: "apps/web/src/lib/api.ts"
      provides: "Axios/fetch wrapper with auth header injection and token refresh"
      contains: "api"
    - path: "apps/web/src/pages/DashboardPage.tsx"
      provides: "Dashboard with presentations list, KB docs, credit balance"
    - path: "apps/web/src/pages/WorkspacePage.tsx"
      provides: "Split-screen workspace layout"
    - path: "apps/web/src/components/layout/SplitScreen.tsx"
      provides: "Resizable split-screen component (chat left, preview right)"
    - path: "apps/web/src/components/auth/ProtectedRoute.tsx"
      provides: "Route guard that redirects to /login if not authenticated"
    - path: "apps/web/src/App.tsx"
      provides: "React Router with all routes defined"
      contains: "BrowserRouter"
  key_links:
    - from: "apps/web/src/stores/auth.store.ts"
      to: "apps/web/src/lib/api.ts"
      via: "auth store calls api for login/register"
      pattern: "api\\.(post|get)"
    - from: "apps/web/src/lib/api.ts"
      to: "backend /auth/* endpoints"
      via: "fetch calls through Vite proxy"
      pattern: "/auth/(login|register|refresh)"
    - from: "apps/web/src/App.tsx"
      to: "apps/web/src/components/auth/ProtectedRoute.tsx"
      via: "wraps authenticated routes"
      pattern: "ProtectedRoute"
    - from: "apps/web/src/components/layout/SplitScreen.tsx"
      to: "apps/web/src/pages/WorkspacePage.tsx"
      via: "SplitScreen rendered in workspace"
      pattern: "SplitScreen"

user_setup:
  - service: resend
    why: "Password reset emails (AUTH-04). Can skip for dev -- reset tokens are logged to console."
    env_vars:
      - name: RESEND_API_KEY
        source: "Resend Dashboard -> API Keys -> Create API Key"
    dashboard_config:
      - task: "Verify a domain for sending emails"
        location: "Resend Dashboard -> Domains"
---

<objective>
Build the frontend shell: auth pages (login, register, forgot/reset password), dashboard, settings page, and split-screen workspace layout. Wire the frontend to the backend auth API.

Purpose: Creates the user-facing frontend that turns the backend API into a usable application. Users can authenticate, see their dashboard, and access the split-screen workspace that will host chat + preview in later phases.

Output: Complete frontend with auth flow, protected routes, dashboard, settings, and split-screen workspace. Frontend communicates with backend via API proxy.
</objective>

<execution_context>
@C:\Users\33641\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\33641\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
@.planning/phases/01-foundation/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create auth store, API client, and auth pages</name>
  <files>
    apps/web/src/stores/auth.store.ts
    apps/web/src/lib/api.ts
    apps/web/src/pages/LoginPage.tsx
    apps/web/src/pages/RegisterPage.tsx
    apps/web/src/pages/ForgotPasswordPage.tsx
    apps/web/src/pages/ResetPasswordPage.tsx
    apps/web/src/components/auth/ProtectedRoute.tsx
  </files>
  <action>
    1. CREATE `apps/web/src/lib/api.ts`:
       - Create a fetch wrapper (or use a thin fetch-based client -- no axios needed)
       - Base URL: empty string (Vite proxy handles /auth/* -> localhost:3000)
       - Add request interceptor: inject Authorization header from auth store tokens
       - Add response interceptor: on 401, attempt token refresh via /auth/refresh
         - If refresh succeeds, retry the original request with new access token
         - If refresh fails, clear auth state and redirect to /login
       - Export typed methods: api.get<T>(url), api.post<T>(url, body), etc.

    2. CREATE `apps/web/src/stores/auth.store.ts`:
       - Zustand store with the following state:
         ```typescript
         interface AuthState {
           user: { id: string; email: string; name: string; role: string; tier: string; creditBalance: number } | null;
           accessToken: string | null;
           refreshToken: string | null;
           isAuthenticated: boolean;
           isLoading: boolean;
           error: string | null;
           login: (email: string, password: string) => Promise<void>;
           register: (email: string, password: string, name: string) => Promise<void>;
           logout: () => Promise<void>;
           refreshTokens: () => Promise<void>;
           forgotPassword: (email: string) => Promise<void>;
           resetPassword: (token: string, newPassword: string) => Promise<void>;
           clearError: () => void;
         }
         ```
       - Persist tokens in localStorage (accessToken, refreshToken)
       - On app load, check localStorage for existing tokens and restore state
       - login/register: call /auth/login or /auth/register, store tokens + user
       - logout: call /auth/logout, clear tokens + user from state and localStorage
       - refreshTokens: call /auth/refresh with refresh token, update stored tokens

    3. CREATE `apps/web/src/components/auth/ProtectedRoute.tsx`:
       - Reads isAuthenticated from auth store
       - If not authenticated, redirect to /login with a returnTo query param
       - If authenticated, render children
       - On mount, check if tokens exist in localStorage (handle page refresh)

    4. CREATE `apps/web/src/pages/LoginPage.tsx`:
       - Card centered on page with Pitchable logo/name
       - Email + password form fields using shadcn Input and Button
       - "Forgot password?" link -> /forgot-password
       - "Don't have an account? Sign up" link -> /register
       - On submit: call auth store login(), redirect to dashboard on success
       - Show error message on failure
       - Tailwind styling: bg-slate-50, card with shadow-md, responsive

    5. CREATE `apps/web/src/pages/RegisterPage.tsx`:
       - Same card layout as login
       - Name + Email + Password + Confirm Password fields
       - "Already have an account? Log in" link -> /login
       - On submit: validate password match, call auth store register(), redirect to dashboard
       - Show error on failure

    6. CREATE `apps/web/src/pages/ForgotPasswordPage.tsx`:
       - Email field only
       - On submit: call auth store forgotPassword(), show success message
       - "Back to login" link

    7. CREATE `apps/web/src/pages/ResetPasswordPage.tsx`:
       - Read token from URL query params
       - New password + confirm password fields
       - On submit: call auth store resetPassword(token, newPassword), redirect to /login on success

    8. Install shadcn components needed:
       ```bash
       cd apps/web && npx shadcn@latest add input card label
       ```
       If CLI fails, manually create these components from the shadcn source.
  </action>
  <verify>
    - `npm run build --workspace=apps/web` succeeds (or `cd apps/web && npx tsc --noEmit`)
    - All page files exist: ls apps/web/src/pages/{Login,Register,ForgotPassword,ResetPassword}Page.tsx
    - Auth store file exists: ls apps/web/src/stores/auth.store.ts
    - API client file exists: ls apps/web/src/lib/api.ts
    - ProtectedRoute exists: ls apps/web/src/components/auth/ProtectedRoute.tsx
  </verify>
  <done>Auth store with Zustand, API client with token refresh, 4 auth pages (login, register, forgot-password, reset-password), and ProtectedRoute guard created.</done>
</task>

<task type="auto">
  <name>Task 2: Create dashboard, settings, split-screen workspace, and router</name>
  <files>
    apps/web/src/App.tsx
    apps/web/src/pages/DashboardPage.tsx
    apps/web/src/pages/SettingsPage.tsx
    apps/web/src/pages/WorkspacePage.tsx
    apps/web/src/components/layout/SplitScreen.tsx
    apps/web/src/components/layout/Sidebar.tsx
    apps/web/src/components/layout/AppLayout.tsx
  </files>
  <action>
    1. CREATE `apps/web/src/components/layout/AppLayout.tsx`:
       - Top navbar with: Pitchable logo (left), user name + avatar placeholder (right), logout button
       - Sidebar with nav links: Dashboard, Settings
       - Main content area (Outlet for nested routes)
       - Responsive: sidebar collapses to hamburger menu on mobile

    2. CREATE `apps/web/src/components/layout/Sidebar.tsx`:
       - Navigation links: Dashboard (/dashboard), Settings (/settings)
       - Active state highlighting using useLocation()
       - Tailwind: fixed left sidebar, w-64 on desktop, hidden on mobile with toggle

    3. CREATE `apps/web/src/pages/DashboardPage.tsx`:
       - Header: "Welcome back, {user.name}"
       - Stats row: Credit balance (from auth store user), Presentations count (0 for now)
       - Presentations list: empty state with "Create your first presentation" CTA button
         - The CTA navigates to /workspace/new (placeholder route for Phase 3)
       - Simple card-based layout using shadcn Card components
       - FE-05: Shows presentations list (empty), KB docs placeholder, credit balance

    4. CREATE `apps/web/src/pages/SettingsPage.tsx`:
       - Account section: name, email (from auth store)
       - Password change section (placeholder form, calls /auth/reset-password later)
       - Billing section: current tier (from auth store user.tier), placeholder for Stripe integration
       - FE-06: Settings page for account management and billing

    5. CREATE `apps/web/src/components/layout/SplitScreen.tsx`:
       - Two-panel layout: left panel (chat) and right panel (preview)
       - Desktop (>= 768px): side-by-side with draggable divider
         - Default split: 40% chat, 60% preview
         - Min widths: 300px each panel
       - Mobile (< 768px): tabbed view with "Chat" and "Preview" tabs
         - Tab bar at top, only one panel visible at a time
       - FE-01: Split-screen layout (chat left, preview right)
       - FE-02: Responsive tabbed view on mobile
       - Both panels render placeholder content for now ("Chat Panel", "Preview Panel")
         - These will be replaced with actual components in Phase 3

    6. CREATE `apps/web/src/pages/WorkspacePage.tsx`:
       - Renders SplitScreen component
       - No sidebar (workspace is full-width)
       - Minimal top bar with: back to dashboard link, presentation title placeholder

    7. UPDATE `apps/web/src/App.tsx` with full routing:
       ```tsx
       <BrowserRouter>
         <Routes>
           {/* Public routes */}
           <Route path="/login" element={<LoginPage />} />
           <Route path="/register" element={<RegisterPage />} />
           <Route path="/forgot-password" element={<ForgotPasswordPage />} />
           <Route path="/reset-password" element={<ResetPasswordPage />} />

           {/* Protected routes with app layout */}
           <Route element={<ProtectedRoute><AppLayout /></ProtectedRoute>}>
             <Route path="/dashboard" element={<DashboardPage />} />
             <Route path="/settings" element={<SettingsPage />} />
           </Route>

           {/* Protected workspace route (no sidebar) */}
           <Route element={<ProtectedRoute><div /></ProtectedRoute>}>
             <Route path="/workspace/:id?" element={<WorkspacePage />} />
           </Route>

           {/* Redirects */}
           <Route path="/" element={<Navigate to="/dashboard" replace />} />
           <Route path="*" element={<Navigate to="/dashboard" replace />} />
         </Routes>
       </BrowserRouter>
       ```

    8. Install additional shadcn components:
       ```bash
       cd apps/web && npx shadcn@latest add tabs avatar dropdown-menu separator
       ```

    9. Verify the full flow works:
       - Start backend: `npm run start:dev` (from root)
       - Start frontend: `npm run dev --workspace=apps/web`
       - Open http://localhost:5173 -> redirected to /login
       - Register a new user -> redirected to /dashboard
       - Dashboard shows user name and empty presentations list
       - Navigate to /settings -> shows account info
       - Navigate to /workspace -> shows split-screen with chat/preview placeholders
       - Resize browser to mobile width -> split-screen collapses to tabs
       - Logout -> redirected to /login
       - Try accessing /dashboard while logged out -> redirected to /login
  </action>
  <verify>
    - `npm run dev --workspace=apps/web` builds without errors
    - All page files exist
    - Register flow works: /register -> fill form -> redirected to /dashboard
    - Login flow works: /login -> fill form -> redirected to /dashboard
    - Protected routes redirect to /login when not authenticated
    - Split-screen layout visible at /workspace
    - Mobile responsive: split-screen becomes tabbed view below 768px
    - Logout clears auth and redirects to /login
  </verify>
  <done>Dashboard, settings, and split-screen workspace pages created. Full routing with protected routes. Auth flow works end-to-end (register -> dashboard -> workspace -> logout).</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete frontend shell with auth, dashboard, settings, and split-screen workspace. Auth flow connected to backend API.</what-built>
  <how-to-verify>
    1. Start Docker services: `docker compose up -d` (from project root)
    2. Start backend: `npm run start:dev` (from project root)
    3. Start frontend: `npm run dev --workspace=apps/web` (from project root)
    4. Open http://localhost:5173 in browser
    5. Verify redirect to /login page
    6. Click "Sign up" and register with test credentials
    7. Verify redirect to /dashboard showing your name and empty presentations list
    8. Click "Settings" in sidebar -> verify account info displayed
    9. Navigate to /workspace -> verify split-screen layout (chat left, preview right)
    10. Resize browser to mobile width (< 768px) -> verify split-screen collapses to tabbed view
    11. Click logout -> verify redirect to /login
    12. Try navigating to /dashboard directly -> verify redirect to /login
    13. Log in with the registered credentials -> verify it works
    14. Open http://localhost:3000/api/docs -> verify Swagger UI loads
    15. Open http://localhost:3000/health -> verify health check returns OK
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
1. Frontend builds without errors
2. Auth flow works end-to-end: register -> login -> dashboard -> logout
3. Protected routes redirect unauthenticated users
4. Dashboard shows user info and empty presentations list
5. Settings page shows account info
6. Split-screen workspace layout renders correctly
7. Mobile responsive: tabbed view below 768px
8. Backend Swagger docs accessible at /api/docs
9. Health check returns 200 at /health
</verification>

<success_criteria>
- FE-01: Split-screen layout with chat left, preview right (placeholders for Phase 3)
- FE-02: Responsive layout collapses to tabbed view on mobile
- FE-04: Auth pages (sign up, log in, forgot password, reset password)
- FE-05: Dashboard showing presentations list (empty), credit balance
- FE-06: Settings page for account management
- FE-07: React 18 + TypeScript + Vite + Tailwind CSS + shadcn/ui (completed with Plan 01)
- AUTH-01 through AUTH-04: End-to-end auth flow working in browser
- Frontend and backend communicate via API (Phase 1 Success Criteria #7)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-06-SUMMARY.md`
</output>
